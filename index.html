<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Visitor Counter</title>
<style>
    body {
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: Arial;
    }

    /* Ø´ÙƒÙ„ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© */
    .counter {
        width: 180px;
        height: 180px;
        border-radius: 50%;
        background: radial-gradient(circle, #fff, #ccc, #999);
        box-shadow: 0 0 25px #fff;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 45px;
        font-weight: bold;
        transition: 0.3s;
        animation: pop 0.4s;
        cursor: pointer;
    }

    /* Ø­Ø±ÙƒØ© */
    @keyframes pop {
        0% { transform: scale(0.6); }
        100% { transform: scale(1); }
    }

    /* Ø£Ù„ÙˆØ§Ù† Ù…Ø®ØªÙ„ÙØ© */
    .red { box-shadow: 0 0 25px red; color: red; }
    .purple { box-shadow: 0 0 25px violet; color: violet; }
    .green { box-shadow: 0 0 25px #0f0; color: #0f0; }
    .white { box-shadow: 0 0 25px white; color: white; }

</style>
</head>
<body>

<div id="counter" class="counter white">0</div>

<!-- ØµÙˆØª Ø§Ù„ÙƒÙ„ÙŠÙƒ -->
<audio id="clickSound">
    <source src="https://www.myinstants.com/media/sounds/mouse-click.mp3">
</audio>

<script type="module">
    /* Firebase */
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

    const firebaseConfig = {
        databaseURL: "https://sdadas-df565-default-rtdb.firebaseio.com/"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const counterDiv = document.getElementById("counter");
    const clickSound = document.getElementById("clickSound");

    const WEBHOOK = "https://canary.discord.com/api/webhooks/1406393110724088064/Xelzjao5HTCSED5VO1pFwb1Gdg5Br_KYe-olWHjtViyMf6bPyzYat1HRxgnArLEbW6ty";

    /* Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø¨Ø§Ù„Ø¥ÙŠ Ø¨ÙŠ */
    async function getIP() {
        const req = await fetch("https://api.ipify.org?format=json");
        const data = await req.json();
        return data.ip;
    }

    async function loadCounter() {
        const ip = await getIP();

        const ipRef = ref(db, "ips/" + ip);
        const ipSnap = await get(ipRef);

        const countRef = ref(db, "visits");
        const countSnap = await get(countRef);

        let count = countSnap.exists() ? countSnap.val() : 0;

        if (!ipSnap.exists()) {
            count++;

            // Ø­ÙØ¸ Ø§Ù„IP
            set(ipRef, true);

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø¯
            set(countRef, count);

            // Ø¥Ø±Ø³Ø§Ù„ Webhook
            fetch(WEBHOOK, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    content: `ğŸ”¥ **Ø²Ø§Ø¦Ø± Ø¬Ø¯ÙŠØ¯ ÙˆØµÙ„!**  
ğŸ“Œ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø¢Ù†: **${count}**  
ğŸŒ IP: ${ip}`
                })
            });
        }

        counterDiv.textContent = count;
    }

    loadCounter();

    /* ØªØºÙŠÙŠØ± Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© */
    const colors = ["red", "purple", "green", "white"];
    let index = 0;

    counterDiv.addEventListener("click", () => {
        clickSound.play();
        index = (index + 1) % colors.length;
        counterDiv.className = "counter " + colors[index];
    });

</script>
</body>
</html>
